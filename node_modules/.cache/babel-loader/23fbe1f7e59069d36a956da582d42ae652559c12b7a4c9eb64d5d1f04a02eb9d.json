{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{db,auth}from\"../firebase-config\";import{collection,addDoc,where,serverTimestamp,onSnapshot,query,orderBy}from\"firebase/firestore\";import\"../styles/Chat.css\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export const Chat=_ref=>{let{room}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState(\"\");const messagesRef=collection(db,\"messages\");useEffect(()=>{const queryMessages=query(messagesRef,where(\"room\",\"==\",room),orderBy(\"createdAt\"));const unsubscribe=onSnapshot(queryMessages,snapshot=>{const messages=[];snapshot.forEach(doc=>{messages.push({...doc.data(),id:doc.id});});setMessages(messages);});return()=>unsubscribe();},[room,messagesRef]);const handleSubmit=async event=>{event.preventDefault();if(newMessage.trim()===\"\")return;await addDoc(messagesRef,{text:newMessage,createdAt:serverTimestamp(),user:auth.currentUser.displayName||\"Anonymous\",room});setNewMessage(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-app\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome to: \",room.toUpperCase()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"messages\",children:messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"user\",children:[message.user,\":\"]}),\" \",message.text]},message.id))}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"new-message-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:event=>setNewMessage(event.target.value),className:\"new-message-input\",placeholder:\"Type your message here...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",children:\"Send\"})]})]});};","map":{"version":3,"names":["React","useState","useEffect","db","auth","collection","addDoc","where","serverTimestamp","onSnapshot","query","orderBy","jsxs","_jsxs","jsx","_jsx","Chat","_ref","room","messages","setMessages","newMessage","setNewMessage","messagesRef","queryMessages","unsubscribe","snapshot","forEach","doc","push","data","id","handleSubmit","event","preventDefault","trim","text","createdAt","user","currentUser","displayName","className","children","toUpperCase","map","message","onSubmit","type","value","onChange","target","placeholder"],"sources":["C:/Users/lovek/Desktop/study/resume projects/chatify/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { db, auth } from \"../firebase-config\";\nimport {\n  collection,\n  addDoc,\n  where,\n  serverTimestamp,\n  onSnapshot,\n  query,\n  orderBy,\n} from \"firebase/firestore\";\n\nimport \"../styles/Chat.css\";\n\nexport const Chat = ({ room }) => {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const messagesRef = collection(db, \"messages\");\n\n  useEffect(() => {\n    const queryMessages = query(\n      messagesRef,\n      where(\"room\", \"==\", room),\n      orderBy(\"createdAt\")\n    );\n    const unsubscribe = onSnapshot(queryMessages, (snapshot) => {\n      const messages = [];\n      snapshot.forEach((doc) => {\n        messages.push({ ...doc.data(), id: doc.id });\n      });\n      setMessages(messages);\n    });\n  \n    return () => unsubscribe();\n  }, [room, messagesRef]);\n  \n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    if (newMessage.trim() === \"\") return;\n    await addDoc(messagesRef, {\n      text: newMessage,\n      createdAt: serverTimestamp(),\n      user: auth.currentUser.displayName || \"Anonymous\",\n      room,\n    });\n\n    setNewMessage(\"\");\n  };\n\n  return (\n    <div className=\"chat-app\">\n      <div className=\"header\">\n        <h1>Welcome to: {room.toUpperCase()}</h1>\n      </div>\n      <div className=\"messages\">\n        {messages.map((message) => (\n          <div key={message.id} className=\"message\">\n            <span className=\"user\">{message.user}:</span> {message.text}\n          </div>\n        ))}\n      </div>\n      <form onSubmit={handleSubmit} className=\"new-message-form\">\n        <input\n          type=\"text\"\n          value={newMessage}\n          onChange={(event) => setNewMessage(event.target.value)}\n          className=\"new-message-input\"\n          placeholder=\"Type your message here...\"\n        />\n        <button type=\"submit\" className=\"send-button\">\n          Send\n        </button>\n      </form>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}